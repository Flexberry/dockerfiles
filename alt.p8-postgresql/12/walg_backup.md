# Бекапирования системой wal-g

Если в файла описания параметров настройки сервиса `.env`
определена переменная `WALG` со значениями `file`, `s3`, то при работе базы данных
включается режим формирования бекапов:
- файловую систему при значении `file`;
- в облачный сервис поддерживаюший протокол `S3` (например [minio](https://hub.docker.com/r/minio/minio)).

При некорректных значениях переменной `WAL_G` бекап не производится.

### Бекап файловой системы по протоколу S3

Переменные определяющие параметы бекапа по протоколу S3 ханятся в фйале конфигурации
`/etc/wal-g.d/server-s3.conf`. 
Параметы по умолчанию указаны в нижеприведенной таблицы.
Они могут быть переодпределены в окружении при вызова контейнера.
Переменные `AWS_ACCESS_KEY_ID`, `AWS_SECRET_ACCESS_KEY` должны быть определены в окружении.

Имя переменной | Описание |Значение по умолчанию
-------------|----------|------------------
**AWS_ACCESS_KEY_ID** | Идентификатор ключа доступа к `S3`(`minio`) серверу | Нет
**AWS_SECRET_ACCESS_KEY**| Секретный ключ доступа к `S3`(`minio`) серверу | Нет
WALE_S3_PREFIX | `URL` каталога обласного сервиса `S3` для бекапа  | s3://pg-backups
AWS_ENDPOINT | `URL` `S3`(`minio`) сервера | http://ip-s3:9000





